{"sha":"74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce","node_id":"MDY6Q29tbWl0NTI5ODc5MDo3NGMyMGEwZmQ1MzZlMWI4NzI1YzRlOTFhM2JhMjhjNmJhZjllY2Nl","commit":{"author":{"name":"Daniel Agar","email":"daniel@agar.ca","date":"2018-07-07T01:40:39Z"},"committer":{"name":"Daniel Agar","email":"daniel@agar.ca","date":"2018-07-08T14:18:13Z"},"message":"ADIS16477 reset on init and increase delay","tree":{"sha":"87ee9f7750be687d6ee922565614d1aec302fd1f","url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/trees/87ee9f7750be687d6ee922565614d1aec302fd1f"},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/commits/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce","html_url":"https://github.com/PX4/PX4-Autopilot/commit/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce/comments","author":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"committer":{"login":"dagar","id":84712,"node_id":"MDQ6VXNlcjg0NzEy","avatar_url":"https://avatars.githubusercontent.com/u/84712?v=4","gravatar_id":"","url":"https://api.github.com/users/dagar","html_url":"https://github.com/dagar","followers_url":"https://api.github.com/users/dagar/followers","following_url":"https://api.github.com/users/dagar/following{/other_user}","gists_url":"https://api.github.com/users/dagar/gists{/gist_id}","starred_url":"https://api.github.com/users/dagar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dagar/subscriptions","organizations_url":"https://api.github.com/users/dagar/orgs","repos_url":"https://api.github.com/users/dagar/repos","events_url":"https://api.github.com/users/dagar/events{/privacy}","received_events_url":"https://api.github.com/users/dagar/received_events","type":"User","site_admin":false},"parents":[{"sha":"00c34d8a2baa1e64601618503f250a244ff40e85","url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/00c34d8a2baa1e64601618503f250a244ff40e85","html_url":"https://github.com/PX4/PX4-Autopilot/commit/00c34d8a2baa1e64601618503f250a244ff40e85"}],"stats":{"total":13,"additions":11,"deletions":2},"files":[{"sha":"1d929f9ecf8efd4956ea3b39c522f4617784b4d4","filename":"src/drivers/imu/adis16477/ADIS16477.cpp","status":"modified","additions":9,"deletions":2,"changes":11,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce/src%2Fdrivers%2Fimu%2Fadis16477%2FADIS16477.cpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce/src%2Fdrivers%2Fimu%2Fadis16477%2FADIS16477.cpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fdrivers%2Fimu%2Fadis16477%2FADIS16477.cpp?ref=74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce","patch":"@@ -68,7 +68,7 @@ static constexpr uint8_t PROD_ID\t= 0x72;\n \n #define PROD_ID_ADIS16477\t0x405D /* ADIS16477 Identification, device number  */\n \n-#define T_STALL\t\t\t\t16\n+#define T_STALL\t\t\t\t200\n \n #define GYROINITIALSENSITIVITY\t\t250\n #define ACCELINITIALSENSITIVITY\t\t(1.0f / 1200.0f)\n@@ -81,6 +81,14 @@ ADIS16477::ADIS16477(int bus, const char *path_accel, const char *path_gyro, uin\n \t_bad_transfers(perf_alloc(PC_COUNT, \"adis16477_bad_transfers\")),\n \t_rotation(rotation)\n {\n+#ifdef GPIO_SPI1_RESET_ADIS16477\n+\t// ADIS16477 reset pin\n+\tstm32_configgpio(GPIO_SPI1_RESET_ADIS16477);\n+\tstm32_gpiowrite(GPIO_SPI1_RESET_ADIS16477, false);\n+\tup_mdelay(10);\n+\tstm32_gpiowrite(GPIO_SPI1_RESET_ADIS16477, true);\n+#endif /* GPIO_SPI1_RESET_ADIS16477 */\n+\n \t_device_id.devid_s.devtype = DRV_ACC_DEVTYPE_ADIS16477;\n \n \t_gyro->_device_id.devid = _device_id.devid;\n@@ -217,7 +225,6 @@ ADIS16477::probe()\n \t\t\treturn PX4_OK;\n \t\t}\n \n-\t\tPX4_ERR(\"PROD_ID attempt %d\", i);\n \t\tup_udelay(T_STALL);\n \t}\n "},{"sha":"e4528893bac43a7d35d2c5c54139f28a19c4bc7c","filename":"src/drivers/imu/adis16477/CMakeLists.txt","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce/src%2Fdrivers%2Fimu%2Fadis16477%2FCMakeLists.txt","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce/src%2Fdrivers%2Fimu%2Fadis16477%2FCMakeLists.txt","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fdrivers%2Fimu%2Fadis16477%2FCMakeLists.txt?ref=74c20a0fd536e1b8725c4e91a3ba28c6baf9ecce","patch":"@@ -33,6 +33,8 @@\n px4_add_module(\n \tMODULE drivers__imu__adis16477\n \tMAIN adis16477\n+\tSTACK_MAIN 1200\n+\tCOMPILE_FLAGS\n \tSRCS\n \t\tADIS16477.cpp\n \t\tADIS16477_gyro.cpp"}]}