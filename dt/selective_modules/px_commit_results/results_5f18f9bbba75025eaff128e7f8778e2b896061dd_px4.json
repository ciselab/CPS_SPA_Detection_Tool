{"sha":"5f18f9bbba75025eaff128e7f8778e2b896061dd","node_id":"MDY6Q29tbWl0NTI5ODc5MDo1ZjE4ZjliYmJhNzUwMjVlYWZmMTI4ZTdmODc3OGUyYjg5NjA2MWRk","commit":{"author":{"name":"Julian Oes","email":"julian@oes.ch","date":"2016-07-07T08:09:06Z"},"committer":{"name":"Lorenz Meier","email":"lm@inf.ethz.ch","date":"2016-07-07T14:48:27Z"},"message":"sdlog2: select MIN < MAX bytes to write\n\nPreviously, the MAX and MIN were both 512 meaning that usually it would\nstart writing at > 512 bytes but only write 512 bytes which results in\na 512 bytes write shortly followed by a e.g. 30 bytes write.\n\nAlso, performance (measured in missed poll updates) seems slightly\nbetter on Snapdragon with bigger chunks.","tree":{"sha":"796b06feeed7fb073650f790fcca94cdceb60c37","url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/trees/796b06feeed7fb073650f790fcca94cdceb60c37"},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/commits/5f18f9bbba75025eaff128e7f8778e2b896061dd","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/5f18f9bbba75025eaff128e7f8778e2b896061dd","html_url":"https://github.com/PX4/PX4-Autopilot/commit/5f18f9bbba75025eaff128e7f8778e2b896061dd","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/5f18f9bbba75025eaff128e7f8778e2b896061dd/comments","author":{"login":"julianoes","id":1419688,"node_id":"MDQ6VXNlcjE0MTk2ODg=","avatar_url":"https://avatars.githubusercontent.com/u/1419688?v=4","gravatar_id":"","url":"https://api.github.com/users/julianoes","html_url":"https://github.com/julianoes","followers_url":"https://api.github.com/users/julianoes/followers","following_url":"https://api.github.com/users/julianoes/following{/other_user}","gists_url":"https://api.github.com/users/julianoes/gists{/gist_id}","starred_url":"https://api.github.com/users/julianoes/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/julianoes/subscriptions","organizations_url":"https://api.github.com/users/julianoes/orgs","repos_url":"https://api.github.com/users/julianoes/repos","events_url":"https://api.github.com/users/julianoes/events{/privacy}","received_events_url":"https://api.github.com/users/julianoes/received_events","type":"User","site_admin":false},"committer":{"login":"LorenzMeier","id":1208119,"node_id":"MDQ6VXNlcjEyMDgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/1208119?v=4","gravatar_id":"","url":"https://api.github.com/users/LorenzMeier","html_url":"https://github.com/LorenzMeier","followers_url":"https://api.github.com/users/LorenzMeier/followers","following_url":"https://api.github.com/users/LorenzMeier/following{/other_user}","gists_url":"https://api.github.com/users/LorenzMeier/gists{/gist_id}","starred_url":"https://api.github.com/users/LorenzMeier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LorenzMeier/subscriptions","organizations_url":"https://api.github.com/users/LorenzMeier/orgs","repos_url":"https://api.github.com/users/LorenzMeier/repos","events_url":"https://api.github.com/users/LorenzMeier/events{/privacy}","received_events_url":"https://api.github.com/users/LorenzMeier/received_events","type":"User","site_admin":false},"parents":[{"sha":"1631cfdc83a37fb52b2022e74bbc4c96d7157ddc","url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/1631cfdc83a37fb52b2022e74bbc4c96d7157ddc","html_url":"https://github.com/PX4/PX4-Autopilot/commit/1631cfdc83a37fb52b2022e74bbc4c96d7157ddc"}],"stats":{"total":8,"additions":7,"deletions":1},"files":[{"sha":"af4cacceeda6021544f617090727030e0b1818ff","filename":"src/modules/sdlog2/sdlog2.c","status":"modified","additions":7,"deletions":1,"changes":8,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/5f18f9bbba75025eaff128e7f8778e2b896061dd/src%2Fmodules%2Fsdlog2%2Fsdlog2.c","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/5f18f9bbba75025eaff128e7f8778e2b896061dd/src%2Fmodules%2Fsdlog2%2Fsdlog2.c","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fmodules%2Fsdlog2%2Fsdlog2.c?ref=5f18f9bbba75025eaff128e7f8778e2b896061dd","patch":"@@ -144,8 +144,14 @@ static bool logwriter_should_exit = false;\t/**< Logwriter thread exit flag */\n static const unsigned MAX_NO_LOGFOLDER = 999;\t/**< Maximum number of log dirs */\n static const unsigned MAX_NO_LOGFILE = 999;\t\t/**< Maximum number of log files */\n static const int LOG_BUFFER_SIZE_DEFAULT = 8192;\n+\n+#if defined __PX4_POSIX\n+static const int MAX_WRITE_CHUNK = 2048;\n+static const int MIN_BYTES_TO_WRITE = 256;\n+#else\n static const int MAX_WRITE_CHUNK = 512;\n-static const int MIN_BYTES_TO_WRITE = 512;\n+static const int MIN_BYTES_TO_WRITE = 256;\n+#endif\n \n static bool _extended_logging = false;\n static bool _gpstime_only = false;"}]}