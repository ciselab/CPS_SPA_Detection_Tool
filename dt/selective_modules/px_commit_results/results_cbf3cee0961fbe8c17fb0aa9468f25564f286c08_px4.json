{"sha":"cbf3cee0961fbe8c17fb0aa9468f25564f286c08","node_id":"MDY6Q29tbWl0NTI5ODc5MDpjYmYzY2VlMDk2MWZiZThjMTdmYjBhYTk0NjhmMjU1NjRmMjg2YzA4","commit":{"author":{"name":"CarlOlsson","email":"carlolsson.co@gmail.com","date":"2018-04-05T12:46:45Z"},"committer":{"name":"Lorenz Meier","email":"lorenz@px4.io","date":"2018-04-19T05:52:15Z"},"message":"ll40ls: increase the number of samples used to find a correlation peak for LitarLite\n\nSigned-off-by: CarlOlsson <carlolsson.co@gmail.com>","tree":{"sha":"e9cbccd01785edc11efd30d33e49028f511265cf","url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/trees/e9cbccd01785edc11efd30d33e49028f511265cf"},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/commits/cbf3cee0961fbe8c17fb0aa9468f25564f286c08","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/cbf3cee0961fbe8c17fb0aa9468f25564f286c08","html_url":"https://github.com/PX4/PX4-Autopilot/commit/cbf3cee0961fbe8c17fb0aa9468f25564f286c08","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/cbf3cee0961fbe8c17fb0aa9468f25564f286c08/comments","author":{"login":"CarlOlsson","id":7795133,"node_id":"MDQ6VXNlcjc3OTUxMzM=","avatar_url":"https://avatars.githubusercontent.com/u/7795133?v=4","gravatar_id":"","url":"https://api.github.com/users/CarlOlsson","html_url":"https://github.com/CarlOlsson","followers_url":"https://api.github.com/users/CarlOlsson/followers","following_url":"https://api.github.com/users/CarlOlsson/following{/other_user}","gists_url":"https://api.github.com/users/CarlOlsson/gists{/gist_id}","starred_url":"https://api.github.com/users/CarlOlsson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CarlOlsson/subscriptions","organizations_url":"https://api.github.com/users/CarlOlsson/orgs","repos_url":"https://api.github.com/users/CarlOlsson/repos","events_url":"https://api.github.com/users/CarlOlsson/events{/privacy}","received_events_url":"https://api.github.com/users/CarlOlsson/received_events","type":"User","site_admin":false},"committer":{"login":"LorenzMeier","id":1208119,"node_id":"MDQ6VXNlcjEyMDgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/1208119?v=4","gravatar_id":"","url":"https://api.github.com/users/LorenzMeier","html_url":"https://github.com/LorenzMeier","followers_url":"https://api.github.com/users/LorenzMeier/followers","following_url":"https://api.github.com/users/LorenzMeier/following{/other_user}","gists_url":"https://api.github.com/users/LorenzMeier/gists{/gist_id}","starred_url":"https://api.github.com/users/LorenzMeier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LorenzMeier/subscriptions","organizations_url":"https://api.github.com/users/LorenzMeier/orgs","repos_url":"https://api.github.com/users/LorenzMeier/repos","events_url":"https://api.github.com/users/LorenzMeier/events{/privacy}","received_events_url":"https://api.github.com/users/LorenzMeier/received_events","type":"User","site_admin":false},"parents":[{"sha":"d75fd72c02ff0cc12c179d212f5043d3ef6f7270","url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/d75fd72c02ff0cc12c179d212f5043d3ef6f7270","html_url":"https://github.com/PX4/PX4-Autopilot/commit/d75fd72c02ff0cc12c179d212f5043d3ef6f7270"}],"stats":{"total":17,"additions":14,"deletions":3},"files":[{"sha":"c5a9066c18cffda06048ea205d69b59ddfc3edfc","filename":"src/drivers/distance_sensor/ll40ls/LidarLiteI2C.cpp","status":"modified","additions":11,"deletions":3,"changes":14,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/cbf3cee0961fbe8c17fb0aa9468f25564f286c08/src%2Fdrivers%2Fdistance_sensor%2Fll40ls%2FLidarLiteI2C.cpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/cbf3cee0961fbe8c17fb0aa9468f25564f286c08/src%2Fdrivers%2Fdistance_sensor%2Fll40ls%2FLidarLiteI2C.cpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fdrivers%2Fdistance_sensor%2Fll40ls%2FLidarLiteI2C.cpp?ref=cbf3cee0961fbe8c17fb0aa9468f25564f286c08","patch":"@@ -329,18 +329,26 @@ int LidarLiteI2C::measure()\n }\n \n /*\n-  reset the sensor to power on defaults\n+  reset the sensor to power on defaults plus additional configurations\n  */\n int LidarLiteI2C::reset_sensor()\n {\n-\tint ret = write_reg(LL40LS_MEASURE_REG, LL40LS_MSRREG_RESET);\n-\n+\tint ret;\n+\tret = write_reg(LL40LS_MEASURE_REG, LL40LS_MSRREG_RESET);\n \tif (ret != OK) {\n \t\treturn ret;\n \t}\n \n \t// wait for sensor reset to complete\n \tusleep(1000);\n+\tret = write_reg(LL40LS_SIG_COUNT_VAL_REG, LL40LS_SIG_COUNT_VAL_MAX);\n+\n+\tif (ret != OK) {\n+\t\treturn ret;\n+\t}\n+\n+\t// wait for register write to complete\n+\tusleep(1000);\n \n \treturn OK;\n }"},{"sha":"f2252ab19ad473a2796109002e6b2dc81b194b30","filename":"src/drivers/distance_sensor/ll40ls/LidarLiteI2C.h","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/cbf3cee0961fbe8c17fb0aa9468f25564f286c08/src%2Fdrivers%2Fdistance_sensor%2Fll40ls%2FLidarLiteI2C.h","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/cbf3cee0961fbe8c17fb0aa9468f25564f286c08/src%2Fdrivers%2Fdistance_sensor%2Fll40ls%2FLidarLiteI2C.h","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fdrivers%2Fdistance_sensor%2Fll40ls%2FLidarLiteI2C.h?ref=cbf3cee0961fbe8c17fb0aa9468f25564f286c08","patch":"@@ -68,6 +68,9 @@\n #define LL40LS_SW_VERSION         0x4f\n #define LL40LS_SIGNAL_STRENGTH_REG  0x5b\n \n+#define LL40LS_SIG_COUNT_VAL_REG      0x02        /* Maximum acquisition count register */\n+#define LL40LS_SIG_COUNT_VAL_MAX     0xFF        /* Maximum acquisition count max value */\n+\n class LidarLiteI2C : public LidarLite, public device::I2C\n {\n public:"}]}