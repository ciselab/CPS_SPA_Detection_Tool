{"sha":"a24fdb93c38cdedc91041bdc81238815b9d4b023","node_id":"MDY6Q29tbWl0NTI5ODc5MDphMjRmZGI5M2MzOGNkZWRjOTEwNDFiZGM4MTIzODgxNWI5ZDRiMDIz","commit":{"author":{"name":"Dennis Mannhart","email":"dennis.mannhart@gmail.com","date":"2018-08-23T06:26:22Z"},"committer":{"name":"ChristophTobler","email":"ChristophTobler@users.noreply.github.com","date":"2018-08-30T07:27:48Z"},"message":"FlightTaskManual: increase rc timeout to 1.5 x COM_RC_LOSS_T","tree":{"sha":"7d5e96467e8a59212afaea0740fe492b4ec9e8b9","url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/trees/7d5e96467e8a59212afaea0740fe492b4ec9e8b9"},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/commits/a24fdb93c38cdedc91041bdc81238815b9d4b023","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/a24fdb93c38cdedc91041bdc81238815b9d4b023","html_url":"https://github.com/PX4/PX4-Autopilot/commit/a24fdb93c38cdedc91041bdc81238815b9d4b023","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/a24fdb93c38cdedc91041bdc81238815b9d4b023/comments","author":{"login":"Stifael","id":13449161,"node_id":"MDQ6VXNlcjEzNDQ5MTYx","avatar_url":"https://avatars.githubusercontent.com/u/13449161?v=4","gravatar_id":"","url":"https://api.github.com/users/Stifael","html_url":"https://github.com/Stifael","followers_url":"https://api.github.com/users/Stifael/followers","following_url":"https://api.github.com/users/Stifael/following{/other_user}","gists_url":"https://api.github.com/users/Stifael/gists{/gist_id}","starred_url":"https://api.github.com/users/Stifael/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Stifael/subscriptions","organizations_url":"https://api.github.com/users/Stifael/orgs","repos_url":"https://api.github.com/users/Stifael/repos","events_url":"https://api.github.com/users/Stifael/events{/privacy}","received_events_url":"https://api.github.com/users/Stifael/received_events","type":"User","site_admin":false},"committer":{"login":"ChristophTobler","id":14769636,"node_id":"MDQ6VXNlcjE0NzY5NjM2","avatar_url":"https://avatars.githubusercontent.com/u/14769636?v=4","gravatar_id":"","url":"https://api.github.com/users/ChristophTobler","html_url":"https://github.com/ChristophTobler","followers_url":"https://api.github.com/users/ChristophTobler/followers","following_url":"https://api.github.com/users/ChristophTobler/following{/other_user}","gists_url":"https://api.github.com/users/ChristophTobler/gists{/gist_id}","starred_url":"https://api.github.com/users/ChristophTobler/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChristophTobler/subscriptions","organizations_url":"https://api.github.com/users/ChristophTobler/orgs","repos_url":"https://api.github.com/users/ChristophTobler/repos","events_url":"https://api.github.com/users/ChristophTobler/events{/privacy}","received_events_url":"https://api.github.com/users/ChristophTobler/received_events","type":"User","site_admin":false},"parents":[{"sha":"1f1c9fde01f7703bee532224ca45db43bbd198bb","url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/1f1c9fde01f7703bee532224ca45db43bbd198bb","html_url":"https://github.com/PX4/PX4-Autopilot/commit/1f1c9fde01f7703bee532224ca45db43bbd198bb"}],"stats":{"total":11,"additions":9,"deletions":2},"files":[{"sha":"6e9b24e91b39f89345929b6bed01d5f86abe97f0","filename":"src/lib/FlightTasks/tasks/Auto/FlightTaskAuto.cpp","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/a24fdb93c38cdedc91041bdc81238815b9d4b023/src%2Flib%2FFlightTasks%2Ftasks%2FAuto%2FFlightTaskAuto.cpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/a24fdb93c38cdedc91041bdc81238815b9d4b023/src%2Flib%2FFlightTasks%2Ftasks%2FAuto%2FFlightTaskAuto.cpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Flib%2FFlightTasks%2Ftasks%2FAuto%2FFlightTaskAuto.cpp?ref=a24fdb93c38cdedc91041bdc81238815b9d4b023","patch":"@@ -262,10 +262,12 @@ void FlightTaskAuto::_set_heading_from_mode()\n \t\tif (v.length() > NAV_ACC_RAD.get()) {\n \t\t\t_compute_heading_from_2D_vector(_yaw_setpoint, v);\n \t\t\t_yaw_lock = false;\n+\n \t\t} else {\n \t\t\tif (!_yaw_lock) {\n \t\t\t\t_yaw_setpoint = _yaw;\n \t\t\t\t_yaw_lock = true;\n+\t\t\t}\n \t\t}\n \n \t} else {"},{"sha":"68ebd7e3f1cf3ecbe07960406d0d3b7ed5434d3d","filename":"src/lib/FlightTasks/tasks/Manual/FlightTaskManual.cpp","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/a24fdb93c38cdedc91041bdc81238815b9d4b023/src%2Flib%2FFlightTasks%2Ftasks%2FManual%2FFlightTaskManual.cpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/a24fdb93c38cdedc91041bdc81238815b9d4b023/src%2Flib%2FFlightTasks%2Ftasks%2FManual%2FFlightTaskManual.cpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Flib%2FFlightTasks%2Ftasks%2FManual%2FFlightTaskManual.cpp?ref=a24fdb93c38cdedc91041bdc81238815b9d4b023","patch":"@@ -37,8 +37,10 @@\n #include \"FlightTaskManual.hpp\"\n #include <mathlib/mathlib.h>\n #include <float.h>\n+#include <drivers/drv_hrt.h>\n \n using namespace matrix;\n+using namespace time_literals;\n \n bool FlightTaskManual::initializeSubscriptions(SubscriptionArray &subscription_array)\n {\n@@ -67,8 +69,10 @@ bool FlightTaskManual::updateInitialize()\n \n bool FlightTaskManual::_evaluateSticks()\n {\n+\thrt_abstime rc_timeout = (COM_RC_LOSS_T.get() * 1.5f) * 1_s;\n+\n \t/* Sticks are rescaled linearly and exponentially to [-1,1] */\n-\tif ((_time_stamp_current - _sub_manual_control_setpoint->get().timestamp) < _timeout) {\n+\tif ((_time_stamp_current - _sub_manual_control_setpoint->get().timestamp) < rc_timeout) {\n \n \t\t/* Linear scale  */\n \t\t_sticks(0) = _sub_manual_control_setpoint->get().x; /* NED x, \"pitch\" [-1,1] */"},{"sha":"fa3df95434a1e988e4c954a77a7c26da830f4ee5","filename":"src/lib/FlightTasks/tasks/Manual/FlightTaskManual.hpp","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/a24fdb93c38cdedc91041bdc81238815b9d4b023/src%2Flib%2FFlightTasks%2Ftasks%2FManual%2FFlightTaskManual.hpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/a24fdb93c38cdedc91041bdc81238815b9d4b023/src%2Flib%2FFlightTasks%2Ftasks%2FManual%2FFlightTaskManual.hpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Flib%2FFlightTasks%2Ftasks%2FManual%2FFlightTaskManual.hpp?ref=a24fdb93c38cdedc91041bdc81238815b9d4b023","patch":"@@ -76,6 +76,7 @@ class FlightTaskManual : public FlightTask\n \t\t\t\t\t(ParamFloat<px4::params::MPC_Z_MAN_EXPO>)\n \t\t\t\t\t_z_vel_man_expo, /**< ratio of exponential curve for stick input in z direction */\n \t\t\t\t\t(ParamFloat<px4::params::MPC_YAW_EXPO>)\n-\t\t\t\t\t_yaw_expo /**< ratio of exponential curve for stick input in yaw for modes except acro */\n+\t\t\t\t\t_yaw_expo, /**< ratio of exponential curve for stick input in yaw for modes except acro */\n+\t\t\t\t\t(ParamFloat<px4::params::COM_RC_LOSS_T>) COM_RC_LOSS_T /**< time at which commander considers RC lost */\n \t\t\t\t       )\n };"}]}