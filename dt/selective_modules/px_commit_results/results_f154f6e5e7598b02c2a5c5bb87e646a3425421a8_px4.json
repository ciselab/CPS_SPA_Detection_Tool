{"sha":"f154f6e5e7598b02c2a5c5bb87e646a3425421a8","node_id":"MDY6Q29tbWl0NTI5ODc5MDpmMTU0ZjZlNWU3NTk4YjAyYzJhNWM1YmI4N2U2NDZhMzQyNTQyMWE4","commit":{"author":{"name":"Lorenz Meier","email":"lm@inf.ethz.ch","date":"2015-05-15T07:42:35Z"},"committer":{"name":"Lorenz Meier","email":"lm@inf.ethz.ch","date":"2015-05-15T09:16:11Z"},"message":"MAVLink transmission: Allow faster overall transmissions.","tree":{"sha":"d62d3e4b6177c323becd2f2a5f1f923e7e139341","url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/trees/d62d3e4b6177c323becd2f2a5f1f923e7e139341"},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/commits/f154f6e5e7598b02c2a5c5bb87e646a3425421a8","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/f154f6e5e7598b02c2a5c5bb87e646a3425421a8","html_url":"https://github.com/PX4/PX4-Autopilot/commit/f154f6e5e7598b02c2a5c5bb87e646a3425421a8","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/comments","author":{"login":"LorenzMeier","id":1208119,"node_id":"MDQ6VXNlcjEyMDgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/1208119?v=4","gravatar_id":"","url":"https://api.github.com/users/LorenzMeier","html_url":"https://github.com/LorenzMeier","followers_url":"https://api.github.com/users/LorenzMeier/followers","following_url":"https://api.github.com/users/LorenzMeier/following{/other_user}","gists_url":"https://api.github.com/users/LorenzMeier/gists{/gist_id}","starred_url":"https://api.github.com/users/LorenzMeier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LorenzMeier/subscriptions","organizations_url":"https://api.github.com/users/LorenzMeier/orgs","repos_url":"https://api.github.com/users/LorenzMeier/repos","events_url":"https://api.github.com/users/LorenzMeier/events{/privacy}","received_events_url":"https://api.github.com/users/LorenzMeier/received_events","type":"User","site_admin":false},"committer":{"login":"LorenzMeier","id":1208119,"node_id":"MDQ6VXNlcjEyMDgxMTk=","avatar_url":"https://avatars.githubusercontent.com/u/1208119?v=4","gravatar_id":"","url":"https://api.github.com/users/LorenzMeier","html_url":"https://github.com/LorenzMeier","followers_url":"https://api.github.com/users/LorenzMeier/followers","following_url":"https://api.github.com/users/LorenzMeier/following{/other_user}","gists_url":"https://api.github.com/users/LorenzMeier/gists{/gist_id}","starred_url":"https://api.github.com/users/LorenzMeier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LorenzMeier/subscriptions","organizations_url":"https://api.github.com/users/LorenzMeier/orgs","repos_url":"https://api.github.com/users/LorenzMeier/repos","events_url":"https://api.github.com/users/LorenzMeier/events{/privacy}","received_events_url":"https://api.github.com/users/LorenzMeier/received_events","type":"User","site_admin":false},"parents":[{"sha":"4fb91f47cdc5cb7925c7bf2feb46c64551081883","url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/4fb91f47cdc5cb7925c7bf2feb46c64551081883","html_url":"https://github.com/PX4/PX4-Autopilot/commit/4fb91f47cdc5cb7925c7bf2feb46c64551081883"}],"stats":{"total":16,"additions":8,"deletions":8},"files":[{"sha":"8c62abb1299099310a3b04eee799419bdab28b2a","filename":"ROMFS/px4fmu_common/init.d/rc.usb","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/ROMFS%2Fpx4fmu_common%2Finit.d%2Frc.usb","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/ROMFS%2Fpx4fmu_common%2Finit.d%2Frc.usb","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/ROMFS%2Fpx4fmu_common%2Finit.d%2Frc.usb?ref=f154f6e5e7598b02c2a5c5bb87e646a3425421a8","patch":"@@ -3,7 +3,7 @@\n # USB MAVLink start\n #\n \n-mavlink start -r 30000 -d /dev/ttyACM0 -x\n+mavlink start -r 80000 -d /dev/ttyACM0 -x\n # Enable a number of interesting streams we want via USB\n mavlink stream -d /dev/ttyACM0 -s PARAM_VALUE -r 200\n mavlink stream -d /dev/ttyACM0 -s MISSION_ITEM -r 50"},{"sha":"8b551aa0e87467a795fed0615bf30481a6ec6fa3","filename":"nuttx-configs/px4fmu-v2/nsh/defconfig","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/nuttx-configs%2Fpx4fmu-v2%2Fnsh%2Fdefconfig","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/nuttx-configs%2Fpx4fmu-v2%2Fnsh%2Fdefconfig","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/nuttx-configs%2Fpx4fmu-v2%2Fnsh%2Fdefconfig?ref=f154f6e5e7598b02c2a5c5bb87e646a3425421a8","patch":"@@ -664,7 +664,7 @@ CONFIG_CDCACM_NWRREQS=4\n CONFIG_CDCACM_NRDREQS=4\n CONFIG_CDCACM_BULKIN_REQLEN=96\n CONFIG_CDCACM_RXBUFSIZE=512\n-CONFIG_CDCACM_TXBUFSIZE=2048\n+CONFIG_CDCACM_TXBUFSIZE=4096\n CONFIG_CDCACM_VENDORID=0x26ac\n CONFIG_CDCACM_PRODUCTID=0x0011\n CONFIG_CDCACM_VENDORSTR=\"3D Robotics\""},{"sha":"0df0c3b5bc915f6288013def784223842c427578","filename":"src/modules/mavlink/mavlink_main.cpp","status":"modified","additions":6,"deletions":6,"changes":12,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/src%2Fmodules%2Fmavlink%2Fmavlink_main.cpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/f154f6e5e7598b02c2a5c5bb87e646a3425421a8/src%2Fmodules%2Fmavlink%2Fmavlink_main.cpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fmodules%2Fmavlink%2Fmavlink_main.cpp?ref=f154f6e5e7598b02c2a5c5bb87e646a3425421a8","patch":"@@ -90,7 +90,7 @@\n static const int ERROR = -1;\n \n #define DEFAULT_DEVICE_NAME\t\t\t\"/dev/ttyS1\"\n-#define MAX_DATA_RATE\t\t\t\t60000\t///< max data rate in bytes/s\n+#define MAX_DATA_RATE\t\t\t\t1000000\t///< max data rate in bytes/s\n #define MAIN_LOOP_DELAY \t\t\t10000\t///< 100 Hz @ 1000 bytes/s data rate\n #define FLOW_CONTROL_DISABLE_THRESHOLD\t\t40\t///< picked so that some messages still would fit it.\n \n@@ -990,7 +990,7 @@ void\n Mavlink::adjust_stream_rates(const float multiplier)\n {\n \t/* do not allow to push us to zero */\n-\tif (multiplier < 0.01f) {\n+\tif (multiplier < 0.0005f) {\n \t\treturn;\n \t}\n \n@@ -1001,9 +1001,9 @@ Mavlink::adjust_stream_rates(const float multiplier)\n \t\tunsigned interval = stream->get_interval();\n \t\tinterval /= multiplier;\n \n-\t\t/* allow max ~600 Hz */\n+\t\t/* allow max ~2000 Hz */\n \t\tif (interval < 1600) {\n-\t\t\tinterval = 1600;\n+\t\t\tinterval = 500;\n \t\t}\n \n \t\t/* set new interval */\n@@ -1375,7 +1375,7 @@ Mavlink::task_main(int argc, char *argv[])\n \n \t/* MAVLINK_FTP stream */\n \t_mavlink_ftp = (MavlinkFTP *) MavlinkFTP::new_instance(this);\n-\t_mavlink_ftp->set_interval(interval_from_rate(120.0f));\n+\t_mavlink_ftp->set_interval(interval_from_rate(1000.0f));\n \tLL_APPEND(_streams, _mavlink_ftp);\n \t\n \t/* MISSION_STREAM stream, actually sends all MISSION_XXX messages at some rate depending on\n@@ -1425,7 +1425,7 @@ Mavlink::task_main(int argc, char *argv[])\n \t}\n \n \t/* set main loop delay depending on data rate to minimize CPU overhead */\n-\t_main_loop_delay = MAIN_LOOP_DELAY * 1000 / _datarate;\n+\t_main_loop_delay = (MAIN_LOOP_DELAY * 1000) / _datarate;\n \n \t/* now the instance is fully initialized and we can bump the instance count */\n \tLL_APPEND(_mavlink_instances, this);"}]}