{"sha":"d9e31d67aa0d742e709616c349f3fc958598c9e2","node_id":"MDY6Q29tbWl0NTI5ODc5MDpkOWUzMWQ2N2FhMGQ3NDJlNzA5NjE2YzM0OWYzZmM5NTg1OThjOWUy","commit":{"author":{"name":"Igor Mišić","email":"igy1000mb@gmail.com","date":"2021-05-07T12:07:33Z"},"committer":{"name":"Beat Küng","email":"beat-kueng@gmx.net","date":"2021-05-11T06:34:23Z"},"message":"gps: Updated timeout time for the rover with moving base\n\nThe MB rover will wait as long as possible to compute a navigation solution, possibly lowering the navigation rate all the way to 1 Hz while doing so.","tree":{"sha":"492b58b9d4aaec2bed0159f8b8fb9942f136ff56","url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/trees/492b58b9d4aaec2bed0159f8b8fb9942f136ff56"},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/git/commits/d9e31d67aa0d742e709616c349f3fc958598c9e2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/d9e31d67aa0d742e709616c349f3fc958598c9e2","html_url":"https://github.com/PX4/PX4-Autopilot/commit/d9e31d67aa0d742e709616c349f3fc958598c9e2","comments_url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/d9e31d67aa0d742e709616c349f3fc958598c9e2/comments","author":{"login":"Igor-Misic","id":10188706,"node_id":"MDQ6VXNlcjEwMTg4NzA2","avatar_url":"https://avatars.githubusercontent.com/u/10188706?v=4","gravatar_id":"","url":"https://api.github.com/users/Igor-Misic","html_url":"https://github.com/Igor-Misic","followers_url":"https://api.github.com/users/Igor-Misic/followers","following_url":"https://api.github.com/users/Igor-Misic/following{/other_user}","gists_url":"https://api.github.com/users/Igor-Misic/gists{/gist_id}","starred_url":"https://api.github.com/users/Igor-Misic/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Igor-Misic/subscriptions","organizations_url":"https://api.github.com/users/Igor-Misic/orgs","repos_url":"https://api.github.com/users/Igor-Misic/repos","events_url":"https://api.github.com/users/Igor-Misic/events{/privacy}","received_events_url":"https://api.github.com/users/Igor-Misic/received_events","type":"User","site_admin":false},"committer":{"login":"bkueng","id":281593,"node_id":"MDQ6VXNlcjI4MTU5Mw==","avatar_url":"https://avatars.githubusercontent.com/u/281593?v=4","gravatar_id":"","url":"https://api.github.com/users/bkueng","html_url":"https://github.com/bkueng","followers_url":"https://api.github.com/users/bkueng/followers","following_url":"https://api.github.com/users/bkueng/following{/other_user}","gists_url":"https://api.github.com/users/bkueng/gists{/gist_id}","starred_url":"https://api.github.com/users/bkueng/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bkueng/subscriptions","organizations_url":"https://api.github.com/users/bkueng/orgs","repos_url":"https://api.github.com/users/bkueng/repos","events_url":"https://api.github.com/users/bkueng/events{/privacy}","received_events_url":"https://api.github.com/users/bkueng/received_events","type":"User","site_admin":false},"parents":[{"sha":"b7e563bdbeec1a22ea983badb6c3b47b7e1736d9","url":"https://api.github.com/repos/PX4/PX4-Autopilot/commits/b7e563bdbeec1a22ea983badb6c3b47b7e1736d9","html_url":"https://github.com/PX4/PX4-Autopilot/commit/b7e563bdbeec1a22ea983badb6c3b47b7e1736d9"}],"stats":{"total":12,"additions":10,"deletions":2},"files":[{"sha":"3b86b6dc238e45e4af0e8d81e09a440ee8779d3c","filename":"src/drivers/gps/gps.cpp","status":"modified","additions":10,"deletions":2,"changes":12,"blob_url":"https://github.com/PX4/PX4-Autopilot/blob/d9e31d67aa0d742e709616c349f3fc958598c9e2/src%2Fdrivers%2Fgps%2Fgps.cpp","raw_url":"https://github.com/PX4/PX4-Autopilot/raw/d9e31d67aa0d742e709616c349f3fc958598c9e2/src%2Fdrivers%2Fgps%2Fgps.cpp","contents_url":"https://api.github.com/repos/PX4/PX4-Autopilot/contents/src%2Fdrivers%2Fgps%2Fgps.cpp?ref=d9e31d67aa0d742e709616c349f3fc958598c9e2","patch":"@@ -75,7 +75,8 @@\n #include <linux/spi/spidev.h>\n #endif /* __PX4_LINUX */\n \n-#define TIMEOUT_5HZ 500\n+#define TIMEOUT_1HZ\t\t1300\t//!< Timeout time in mS, 1000 mS (1Hz) + 300 mS delta for error\n+#define TIMEOUT_5HZ\t\t500\t\t//!< Timeout time in mS,  200 mS (5Hz) + 300 mS delta for error\n #define RATE_MEASUREMENT_PERIOD 5000000\n \n typedef enum {\n@@ -837,8 +838,15 @@ GPS::run()\n \t\t\t}\n \n \t\t\tint helper_ret;\n+\t\t\tunsigned receive_timeout = TIMEOUT_5HZ;\n \n-\t\t\twhile ((helper_ret = _helper->receive(TIMEOUT_5HZ)) > 0 && !should_exit()) {\n+\t\t\tif (ubx_mode == GPSDriverUBX::UBXMode::RoverWithMovingBase) {\n+\t\t\t\t/* The MB rover will wait as long as possible to compute a navigation solution,\n+\t\t\t\t * possibly lowering the navigation rate all the way to 1 Hz while doing so. */\n+\t\t\t\treceive_timeout = TIMEOUT_1HZ;\n+\t\t\t}\n+\n+\t\t\twhile ((helper_ret = _helper->receive(receive_timeout)) > 0 && !should_exit()) {\n \n \t\t\t\tif (helper_ret & 1) {\n \t\t\t\t\tpublish();"}]}